<!-- /////////  begin draw_controls ////////////////////////////////////////////////// -->   
<div class='map_draw_controls'>
  <ul id="controlToggle">
    <li class='border_top_thin'>
      <input type="radio" name="type" value="none" id="noneToggle"
      onclick="toggleControl(this);" checked="checked" />
      <label for="noneToggle">navigate</label>
    </li>
    <li>
      <input type="radio" name="type" value="line" id="lineToggle" onclick="toggleControl(this);" />
      <label for="lineToggle">draw a line<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end: dbl-clck</label>
    </li>
    <li>
      <input type="radio" name="type" value="modify" id="modifyToggle"
      onclick="toggleControl(this);" onchange="update();" />
      <label for="modifyToggle">modify a line</label>
    </li>
    <li>
      <input type="radio" name="type" value="select" id="selectToggle" onclick="toggleControl(this);" />
      <label for="selectToggle">delete a line</label>
    </li>
  </ul>
  <%= button_to "revert", @theme_map, class: "nav_link", id: "revert_geo_db", remote: true  %>
  <%= button_to "save", @theme_map, class: "nav_link", id: "update_geo_db", remote: true  %>
  <div style="height: 30px; width: 90px;">
    <div id="indicator" style="display: none; height: 20px; text-align: center;" >Edits Saved</div>
  </div>
  <%= button_to "help", @theme_map, class: "nav_link", id: "help", remote: true %>
</div>


<script defer=defer type='text/javascript'>

  function showHelp(){
//    win = new Window('1', {className: "alphacube", title: '<%=@theme_map.name %>',
//        width:340, height:450, top:70, left:100, zIndex:1500,
//        destroyOnClose: true });
//    win.setAjaxContent("/theme_maps/<%=@theme_map.slug%>/send_help",{id: '<%=@theme_map.name.dashed %>'});
//    win.show();
  }


  function revertSaved(){ // returns javascript to refresh the interactive layers...
//    emptyFeatures();
//    new Ajax.Request("/theme_maps/<%=@theme_map.slug%>/revert_geo_db", {
//      parameters: {
//        id: '<%=@theme_map.slug%>'
//      },
//    });
  }

  $('#update_geo_db').click(function() {
      console.log("in update_geo_db.click --> ", geometries.toSource(), geometry_labels.toSource());
    var request = $.ajax({
      url: "/theme_maps/<%=@theme_map.slug%>/update_geo_db",
      type: "POST",
      data: {geometries: geometries.toSource(), labels: geometry_labels.toSource()},
      dataType: "html"
    });

    request.done(function( msg ) {
      $("#rails_error").text("it says we're done: " + msg);
    });

    request.fail(function( jqXHR, textStatus ) {
      $("#rails_error").text("error: " + jqXHR.responseXML);
    });
  });

//        onSuccess: function(){
//          $("indicator").show();
//          $("indicator").fade({ duration: 5.0 });
//          }

</script>
<!--  end draw_controls ////////////////////////////////////////////////// --> 
